"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[8056],{17757:(e,t,a)=>{var n=a(99489);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(51265)),l=n(a(32735)),o=n(a(76470)),u=a(20763),i=a(9808),s=a(10938),d=a(5636),c=n(a(60216)),f=function(e){var t=e.tokenName,a=e.onClickDelete,n=(0,d.useIntl)().formatMessage,c=(0,s.useTracking)().trackUsage;return l.default.createElement(i.Box,(0,r.default)({paddingLeft:1},s.stopPropagation),l.default.createElement(u.IconButton,{onClick:function(){c("willDeleteToken"),a()},label:n({id:"app.component.table.delete",defaultMessage:"Delete {target}"},{target:"".concat(t)}),noBorder:!0,icon:l.default.createElement(o.default,null)}))};f.propTypes={tokenName:c.default.string.isRequired,onClickDelete:c.default.func.isRequired};var p=f;t.default=p},82793:(e,t,a)=>{var n=a(99489);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(32735)),l=n(a(95717)),o=a(5636),u=n(a(60216)),i=a(58434),s=a(60530),d=(0,n(a(19615)).default)(i.Link).withConfig({displayName:"UpdateButton__LinkUpdate",componentId:"sc-13tqcqf-0"})(["svg{path{fill:",";}}&:hover{svg{path{fill:",";}}}"],(function(e){return e.theme.colors.neutral500}),(function(e){return e.theme.colors.neutral800})),c=function(e){var t=e.tokenName,a=e.tokenId,n=(0,o.useIntl)().formatMessage,u=(0,s.useHistory)().location.pathname;return r.default.createElement(d,{to:"".concat(u,"/").concat(a),title:n({id:"app.component.table.edit",defaultMessage:"Edit {target}"},{target:"".concat(t)})},r.default.createElement(l.default,null))};c.propTypes={tokenName:u.default.string.isRequired,tokenId:u.default.oneOfType([u.default.string,u.default.number]).isRequired};var f=c;t.default=f},83284:(e,t,a)=>{var n=a(99489);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(51265)),l=n(a(61432)),o=n(a(32735)),u=a(95602),i=a(53214),s=a(19192),d=a(10938),c=a(5636),f=n(a(60216)),p=a(60530),m=n(a(17757)),k=n(a(82793)),g=function(e){var t=e.canDelete,a=e.canUpdate,n=e.onClickDelete,f=e.withBulkActions,g=e.rows,y=(0,c.useIntl)().formatMessage,v=(0,d.useQueryParams)(),T=(0,l.default)(v,1)[0].query.sort.split(":"),E=(0,l.default)(T,2)[1],h=(0,p.useHistory)(),b=h.push,w=h.location.pathname,C=(0,d.useTracking)().trackUsage,M=g.sort((function(e,t){var a=e.name.localeCompare(t.name);return"DESC"===E?-a:a}));return o.default.createElement(i.Tbody,null,M.map((function(e){return o.default.createElement(i.Tr,(0,r.default)({key:e.id},(0,d.onRowClick)({fn:function(){C("willEditTokenFromList"),b("".concat(w,"/").concat(e.id))},condition:a})),o.default.createElement(i.Td,null,o.default.createElement(u.Typography,{textColor:"neutral800",fontWeight:"bold"},e.name)),o.default.createElement(i.Td,{maxWidth:(0,d.pxToRem)(250)},o.default.createElement(u.Typography,{textColor:"neutral800",ellipsis:!0},e.description)),o.default.createElement(i.Td,null,o.default.createElement(u.Typography,{textColor:"neutral800"},y({id:"Settings.apiTokens.types.".concat(e.type),defaultMessage:"Type unknown"}))),o.default.createElement(i.Td,null,o.default.createElement(u.Typography,{textColor:"neutral800"},o.default.createElement(d.RelativeTime,{timestamp:new Date(e.createdAt)}))),f&&o.default.createElement(i.Td,null,o.default.createElement(s.Flex,{justifyContent:"end"},a&&o.default.createElement(k.default,{tokenName:e.name,tokenId:e.id}),t&&o.default.createElement(m.default,{tokenName:e.name,onClickDelete:function(){return n(e.id)}}))))})))};g.defaultProps={canDelete:!1,canUpdate:!1,onClickDelete:function(){},rows:[],withBulkActions:!1},g.propTypes={canDelete:f.default.bool,canUpdate:f.default.bool,onClickDelete:f.default.func,rows:f.default.array,withBulkActions:f.default.bool};var y=g;t.default=y},14435:(e,t,a)=>{var n=a(99489),r=a(45559);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=n(a(28129)),o=n(a(68357)),u=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!==typeof e)return{default:e};var a=b(t);if(a&&a.has(e))return a.get(e);var n={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var u=l?Object.getOwnPropertyDescriptor(e,o):null;u&&(u.get||u.set)?Object.defineProperty(n,o,u):n[o]=e[o]}n.default=e,a&&a.set(e,n);return n}(a(32735)),i=a(5636),s=a(10938),d=a(11856),c=a(16540),f=a(44526),p=a(74064),m=n(a(59290)),k=a(84968),g=a(60530),y=n(a(31321)),v=a(17888),T=n(a(59700)),E=n(a(58855)),h=n(a(83284));function b(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(b=function(e){return e?a:t})(e)}var w=function(){(0,s.useFocusWhenNavigate)();var e=(0,k.useQueryClient)(),t=(0,i.useIntl)().formatMessage,a=(0,s.useNotification)(),n=(0,s.useRBAC)(T.default.settings["api-tokens"]).allowedActions,r=n.canCreate,b=n.canDelete,w=n.canUpdate,C=n.canRead,M=(0,g.useHistory)().push,A=(0,s.useTracking)().trackUsage,P=(0,s.useGuidedTour)().startSection,D=(0,u.useRef)(P);(0,u.useEffect)((function(){D.current&&D.current("apiTokens")}),[]),(0,u.useEffect)((function(){M({search:y.default.stringify({sort:"name:ASC"},{encode:!1})})}),[M]);var _=(0,k.useQuery)(["api-tokens"],(0,o.default)(l.default.mark((function e(){var t,a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return A("willAccessTokenList"),e.next=3,v.axiosInstance.get("/admin/api-tokens");case 3:return t=e.sent,a=t.data.data,A("didAccessTokenList",{number:a.length}),e.abrupt("return",a);case 7:case"end":return e.stop()}}),e)}))),{enabled:C,onError:function(){a({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),I=_.data,x=_.status,O=_.isFetching,L=C&&("success"!==x&&"error"!==x||"success"===x&&O),N=(0,k.useMutation)(function(){var e=(0,o.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.axiosInstance.delete("/admin/api-tokens/".concat(t));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{onSuccess:function(){var t=(0,o.default)(l.default.mark((function t(){return l.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.invalidateQueries(["api-tokens"]);case 2:A("didDeleteToken");case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),onError:function(e){var t,n;null!==e&&void 0!==e&&null!==(t=e.response)&&void 0!==t&&null!==(n=t.data)&&void 0!==n&&n.data?a({type:"warning",message:e.response.data.data}):a({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),j=C&&I,S=C&&!I&&!r,B=C&&!I&&r;return u.default.createElement(c.Main,{"aria-busy":L},u.default.createElement(s.SettingsPageTitle,{name:"API Tokens"}),u.default.createElement(d.HeaderLayout,{title:t({id:"Settings.apiTokens.title",defaultMessage:"API Tokens"}),subtitle:t({id:"Settings.apiTokens.description",defaultMessage:"List of generated tokens to consume the API"}),primaryAction:r?u.default.createElement(p.LinkButton,{"data-testid":"create-api-token-button",startIcon:u.default.createElement(m.default,null),size:"L",onClick:function(){return A("willAddTokenFromList")},to:"/settings/api-tokens/create"},t({id:"Settings.apiTokens.create",defaultMessage:"Create new API Token"})):void 0}),u.default.createElement(d.ContentLayout,null,!C&&u.default.createElement(s.NoPermissions,null),j&&u.default.createElement(s.DynamicTable,{headers:E.default,contentType:"api-tokens",rows:I,withBulkActions:b||w,isLoading:L,onConfirmDelete:function(e){return N.mutateAsync(e)}},u.default.createElement(h.default,{canDelete:b,canUpdate:w,rows:I,withBulkActions:b||w})),B&&u.default.createElement(s.NoContent,{content:{id:"Settings.apiTokens.addFirstToken",defaultMessage:"Add your first API Token"},action:u.default.createElement(f.Button,{variant:"secondary",startIcon:u.default.createElement(m.default,null)},t({id:"Settings.apiTokens.addNewToken",defaultMessage:"Add new API Token"}))}),S&&u.default.createElement(s.NoContent,{content:{id:"Settings.apiTokens.emptyStateLayout",defaultMessage:"You don\u2019t have any content yet..."}})))};t.default=w},58855:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=[{name:"name",key:"name",metadatas:{label:"Name",sortable:!0}},{name:"description",key:"description",metadatas:{label:"Description",sortable:!1}},{name:"type",key:"type",metadatas:{label:"Token type",sortable:!1}},{name:"createdAt",key:"createdAt",metadatas:{label:"Created at",sortable:!1}}];t.default=a},17937:(e,t,a)=>{var n=a(99489);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a(32735)),l=a(10938),o=n(a(59700)),u=n(a(14435)),i=function(){return r.default.createElement(l.CheckPagePermissions,{permissions:o.default.settings["api-tokens"].main},r.default.createElement(u.default,null))};t.default=i}}]);