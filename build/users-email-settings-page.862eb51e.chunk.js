"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[8418],{7145:(e,t,a)=>{var r=a(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(a(32735)),n=r(a(60216)),i=a(5636),u=a(10938),o=a(83281),d=a(4122),s=a(78330),c=a(44526),f=a(71657),m=a(90353),p=a(86286),g=r(a(45529)),E=function(e){var t=e.template,a=e.onToggle,r=e.onSubmit,n=(0,i.useIntl)().formatMessage;return l.default.createElement(d.ModalLayout,{onClose:a,labelledBy:"".concat(n({id:(0,p.getTrad)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"}),", ").concat(n({id:(0,p.getTrad)(t.display),defaultMessage:t.display}))},l.default.createElement(d.ModalHeader,null,l.default.createElement(f.Breadcrumbs,{label:"".concat(n({id:(0,p.getTrad)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"}),", ").concat(n({id:(0,p.getTrad)(t.display),defaultMessage:t.display}))},l.default.createElement(f.Crumb,null,n({id:(0,p.getTrad)("PopUpForm.header.edit.email-templates"),defaultMessage:"Edit email template"})),l.default.createElement(f.Crumb,null,n({id:(0,p.getTrad)(t.display),defaultMessage:t.display})))),l.default.createElement(o.Formik,{onSubmit:r,initialValues:t,validateOnChange:!1,validationSchema:g.default,enableReinitialize:!0},(function(e){var t,r,i,o,f,g,E,v=e.errors,b=e.values,y=e.handleChange,T=e.isSubmitting;return l.default.createElement(u.Form,null,l.default.createElement(d.ModalBody,null,l.default.createElement(s.Grid,{gap:5},l.default.createElement(s.GridItem,{col:6,s:12},l.default.createElement(u.GenericInput,{intlLabel:{id:(0,p.getTrad)("PopUpForm.Email.options.from.name.label"),defaultMessage:"Shipper name"},name:"options.from.name",onChange:y,value:b.options.from.name,error:null===v||void 0===v||null===(t=v.options)||void 0===t||null===(r=t.from)||void 0===r?void 0:r.name,type:"text"})),l.default.createElement(s.GridItem,{col:6,s:12},l.default.createElement(u.GenericInput,{intlLabel:{id:(0,p.getTrad)("PopUpForm.Email.options.from.email.label"),defaultMessage:"Shipper email"},name:"options.from.email",onChange:y,value:b.options.from.email,error:null===v||void 0===v||null===(i=v.options)||void 0===i||null===(o=i.from)||void 0===o?void 0:o.email,type:"text"})),l.default.createElement(s.GridItem,{col:6,s:12},l.default.createElement(u.GenericInput,{intlLabel:{id:(0,p.getTrad)("PopUpForm.Email.options.response_email.label"),defaultMessage:"Response email"},name:"options.response_email",onChange:y,value:b.options.response_email,error:null===v||void 0===v||null===(f=v.options)||void 0===f?void 0:f.response_email,type:"text"})),l.default.createElement(s.GridItem,{col:6,s:12},l.default.createElement(u.GenericInput,{intlLabel:{id:(0,p.getTrad)("PopUpForm.Email.options.object.label"),defaultMessage:"Subject"},name:"options.object",onChange:y,value:b.options.object,error:null===v||void 0===v||null===(g=v.options)||void 0===g?void 0:g.object,type:"text"})),l.default.createElement(s.GridItem,{col:12,s:12},l.default.createElement(m.Textarea,{label:n({id:(0,p.getTrad)("PopUpForm.Email.options.message.label"),defaultMessage:"Message"}),name:"options.message",onChange:y,value:b.options.message,error:(null===v||void 0===v||null===(E=v.options)||void 0===E?void 0:E.message)&&n({id:v.options.message,defaultMessage:v.options.message})})))),l.default.createElement(d.ModalFooter,{startActions:l.default.createElement(c.Button,{onClick:a,variant:"tertiary"},"Cancel"),endActions:l.default.createElement(c.Button,{loading:T,type:"submit"},"Finish")}))})))};E.propTypes={template:n.default.shape({display:n.default.string,icon:n.default.string,options:n.default.shape({from:n.default.shape({name:n.default.string,email:n.default.string}),message:n.default.string,object:n.default.string,response_email:n.default.string})}).isRequired,onSubmit:n.default.func.isRequired,onToggle:n.default.func.isRequired};var v=E;t.default=v},11577:(e,t,a)=>{var r=a(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(a(32735)),n=r(a(60216)),i=a(5636),u=a(53214),o=a(28004),d=a(95602),s=a(20763),c=r(a(95717)),f=r(a(23101)),m=a(10938),p=r(a(88677)),g=a(86286),E=function(e){var t=e.canUpdate,a=e.onEditClick,r=(0,i.useIntl)().formatMessage;return l.default.createElement(u.Table,{colCount:3,rowCount:3},l.default.createElement(u.Thead,null,l.default.createElement(u.Tr,null,l.default.createElement(u.Th,{width:"1%"},l.default.createElement(o.VisuallyHidden,null,r({id:(0,g.getTrad)("Email.template.table.icon.label"),defaultMessage:"icon"}))),l.default.createElement(u.Th,null,l.default.createElement(d.Typography,{variant:"sigma",textColor:"neutral600"},r({id:(0,g.getTrad)("Email.template.table.name.label"),defaultMessage:"name"}))),l.default.createElement(u.Th,{width:"1%"},l.default.createElement(o.VisuallyHidden,null,r({id:(0,g.getTrad)("Email.template.table.action.label"),defaultMessage:"action"}))))),l.default.createElement(u.Tbody,null,l.default.createElement(u.Tr,(0,m.onRowClick)({fn:function(){return a("reset_password")}}),l.default.createElement(u.Td,null,l.default.createElement(f.default,{"aria-label":r({id:(0,g.getTrad)("Email.template.reset_password"),defaultMessage:"Reset password"})})),l.default.createElement(u.Td,null,l.default.createElement(d.Typography,null,r({id:(0,g.getTrad)("Email.template.reset_password"),defaultMessage:"Reset password"}))),l.default.createElement(u.Td,m.stopPropagation,l.default.createElement(s.IconButton,{onClick:function(){return a("reset_password")},label:r({id:(0,g.getTrad)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:t&&l.default.createElement(c.default,null)}))),l.default.createElement(u.Tr,(0,m.onRowClick)({fn:function(){return a("email_confirmation")}}),l.default.createElement(u.Td,null,l.default.createElement(p.default,{"aria-label":r({id:(0,g.getTrad)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"})})),l.default.createElement(u.Td,null,l.default.createElement(d.Typography,null,r({id:(0,g.getTrad)("Email.template.email_confirmation"),defaultMessage:"Email address confirmation"}))),l.default.createElement(u.Td,m.stopPropagation,l.default.createElement(s.IconButton,{onClick:function(){return a("email_confirmation")},label:r({id:(0,g.getTrad)("Email.template.form.edit.label"),defaultMessage:"Edit a template"}),noBorder:!0,icon:t&&l.default.createElement(c.default,null)})))))};E.propTypes={canUpdate:n.default.bool.isRequired,onEditClick:n.default.func.isRequired};var v=E;t.default=v},54903:(e,t,a)=>{var r=a(34398),l=a(87002);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=r(a(67945)),i=r(a(20566)),u=r(a(85374)),o=r(a(43408)),d=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==l(e)&&"function"!==typeof e)return{default:e};var a=h(t);if(a&&a.has(e))return a.get(e);var r={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if("default"!==i&&Object.prototype.hasOwnProperty.call(e,i)){var u=n?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(r,i,u):r[i]=e[i]}r.default=e,a&&a.set(e,r);return r}(a(32735)),s=a(84968),c=a(5636),f=a(10938),m=a(29270),p=a(16540),g=a(11856),E=r(a(74472)),v=a(86286),b=a(29745),y=r(a(11577)),T=r(a(7145));function h(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(h=function(e){return e?a:t})(e)}function M(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function j(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?M(Object(a),!0).forEach((function(t){(0,i.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):M(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O=function(){var e=(0,c.useIntl)().formatMessage,t=(0,f.useTracking)().trackUsage,a=(0,m.useNotifyAT)().notifyStatus,r=(0,f.useNotification)(),l=(0,f.useOverlayBlocker)(),h=l.lockApp,M=l.unlockApp,O=(0,d.useRef)(t),P=(0,s.useQueryClient)();(0,f.useFocusWhenNavigate)();var w=(0,d.useState)(!1),_=(0,o.default)(w,2),k=_[0],C=_[1],q=(0,d.useState)(null),R=(0,o.default)(q,2),S=R[0],I=R[1],U=(0,d.useMemo)((function(){return{update:E.default.updateEmailTemplates}}),[]),L=(0,f.useRBAC)(U),x=L.isLoading,A=L.allowedActions.canUpdate,F=(0,s.useQuery)("email-templates",(function(){return(0,b.fetchData)()}),{onSuccess:function(){a(e({id:(0,v.getTrad)("Email.template.data.loaded"),defaultMessage:"Email templates has been loaded"}))},onError:function(){r({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),B=F.status,D=F.data,G=x||"success"!==B,H=function(){C((function(e){return!e}))},N=(0,s.useMutation)((function(e){return(0,b.putEmailTemplate)({"email-templates":e})}),{onSuccess:function(){var e=(0,u.default)(n.default.mark((function e(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.invalidateQueries("email-templates");case 2:r({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}}),O.current("didEditEmailTemplates"),M(),H();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),onError:function(){r({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}}),M()},refetchActive:!0}),W=N.isLoading;return G?d.default.createElement(p.Main,{"aria-busy":"true"},d.default.createElement(f.SettingsPageTitle,{name:e({id:(0,v.getTrad)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),d.default.createElement(g.HeaderLayout,{title:e({id:(0,v.getTrad)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),d.default.createElement(g.ContentLayout,null,d.default.createElement(f.LoadingIndicatorPage,null))):d.default.createElement(p.Main,{"aria-busy":W},d.default.createElement(f.SettingsPageTitle,{name:e({id:(0,v.getTrad)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),d.default.createElement(g.HeaderLayout,{title:e({id:(0,v.getTrad)("HeaderNav.link.emailTemplates"),defaultMessage:"Email templates"})}),d.default.createElement(g.ContentLayout,null,d.default.createElement(y.default,{onEditClick:function(e){I(e),H()},canUpdate:A}),k&&d.default.createElement(T.default,{template:D[S],onToggle:H,onSubmit:function(e){h(),O.current("willEditEmailTemplates");var t=j(j({},D),{},(0,i.default)({},S,e));N.mutate(t)}})))},P=function(){return d.default.createElement(f.CheckPagePermissions,{permissions:E.default.readEmailTemplates},d.default.createElement(O,null))};t.default=P},29745:(e,t,a)=>{var r=a(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.putEmailTemplate=t.fetchData=void 0;var l=r(a(67945)),n=r(a(85374)),i=a(86286),u=function(){var e=(0,n.default)(l.default.mark((function e(){var t,a;return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.axiosInstance.get((0,i.getRequestURL)("email-templates"));case 2:return t=e.sent,a=t.data,e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();t.fetchData=u;t.putEmailTemplate=function(e){return i.axiosInstance.put((0,i.getRequestURL)("email-templates"),e)}},45529:(e,t,a)=>{var r=a(87002);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!==typeof e)return{default:e};var a=i(t);if(a&&a.has(e))return a.get(e);var l={},n=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var u in e)if("default"!==u&&Object.prototype.hasOwnProperty.call(e,u)){var o=n?Object.getOwnPropertyDescriptor(e,u):null;o&&(o.get||o.set)?Object.defineProperty(l,u,o):l[u]=e[u]}l.default=e,a&&a.set(e,l);return l}(a(5173)),n=a(10938);function i(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,a=new WeakMap;return(i=function(e){return e?a:t})(e)}var u=l.object().shape({options:l.object().shape({from:l.object().shape({name:l.string().required(n.translatedErrors.required),email:l.string().email(n.translatedErrors.email).required(n.translatedErrors.required)}).required(),response_email:l.string().email(n.translatedErrors.email),object:l.string().required(n.translatedErrors.required),message:l.string().required(n.translatedErrors.required)}).required(n.translatedErrors.required)});t.default=u},26958:(e,t,a)=>{var r=a(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(a(67945)),n=r(a(85374)),i=r(a(43653)),u=a(10938),o=i.default.create({baseURL:"http://localhost:1337"});o.interceptors.request.use(function(){var e=(0,n.default)(l.default.mark((function e(t){return l.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.headers={Authorization:"Bearer ".concat(u.auth.getToken()),Accept:"application/json","Content-Type":"application/json"},e.abrupt("return",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),(function(e){Promise.reject(e)})),o.interceptors.response.use((function(e){return e}),(function(e){var t;throw 401===(null===(t=e.response)||void 0===t?void 0:t.status)&&(u.auth.clearAppStorage(),window.location.reload()),e}));var d=o;t.default=d},8005:(e,t,a)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(92891),l=function(e){return Object.keys(e).reduce((function(t,a){var l=e[a].controllers,n=Object.keys(l).reduce((function(e,t){return(0,r.isEmpty)(l[t])||(e[t]=l[t]),e}),{});return(0,r.isEmpty)(n)||(t[a]={controllers:n}),t}),{})};t.default=l},85084:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=function(e){return e.reduce((function(e,t){return e.push({label:t,value:t}),e}),[])};t.default=a},96758:(e,t,a)=>{var r=a(34398);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=r(a(92569)),n=function(e){return"/".concat(l.default,"/").concat(e)};t.default=n},86286:(e,t,a)=>{var r=a(34398);Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"axiosInstance",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"cleanPermissions",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"formatPolicies",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"getRequestURL",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"getTrad",{enumerable:!0,get:function(){return u.default}});var l=r(a(26958)),n=r(a(8005)),i=r(a(96758)),u=r(a(63080)),o=r(a(85084))}}]);